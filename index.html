<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>NADIA | מרחב בטוח והחלמה</title>
    <meta name="description" content="נדיה - פלטפורמה מקיפה לתמיכה בנפגעי נרקיסיזם: שאלונים, מילון מושגים, צ'אט AI וקהילה תומכת.">
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@200;400;600;800&family=Heebo:wght@300;500;900&display=swap" rel="stylesheet">

    <style>
        :root {
            --brand-primary: #4f46e5;
            --brand-secondary: #818cf8;
            --soft-bg: #f8fafc;
            --success: #10b981;
        }

        body {
            font-family: 'Assistant', 'Heebo', sans-serif;
            background-color: var(--soft-bg);
            color: #0f172a;
            overflow-x: hidden;
        }

        .hero-gradient {
            background: radial-gradient(circle at 10% 20%, rgba(79, 70, 229, 0.05) 0%, rgba(255, 255, 255, 0) 100%);
        }

        .glass-nav {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .premium-card {
            background: white;
            border: 1px solid rgba(0, 0, 0, 0.03);
            box-shadow: 0 4px 20px -5px rgba(0, 0, 0, 0.05);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .premium-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px -10px rgba(79, 70, 229, 0.15);
            border-color: var(--brand-secondary);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--brand-primary) 0%, #6366f1 100%);
            box-shadow: 0 4px 15px -3px rgba(79, 70, 229, 0.4);
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: scale(1.02);
            filter: brightness(1.1);
        }

        .reveal-in {
            animation: fadeIn 0.6s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .chat-bubble-bot {
            border-bottom-right-radius: 4px;
            background: white;
        }

        .chat-bubble-user {
            border-bottom-left-radius: 4px;
            background: var(--brand-primary);
        }

        .simulator-mode .chat-bubble-bot {
            background: #fff1f2;
            border: 1px solid #fecdd3;
            color: #881337;
        }
        
        /* Grid Layout helpers */
        .bento-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        /* Checkbox custom style */
        .custom-checkbox:checked {
            background-color: var(--brand-primary);
            border-color: var(--brand-primary);
        }
    </style>
</head>
<body class="hero-gradient">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, createContext, useContext } = React;

        // --- Icons ---
        const Icon = {
            Shield: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>,
            Zap: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>,
            Heart: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/></svg>,
            Exit: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4m7 14l5-5-5-5m5 5H9"/></svg>,
            ArrowLeft: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path d="M10 19l-7-7m0 0l7-7m-7 7h18"/></svg>,
            BookOpen: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/></svg>,
            Mask: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path d="M2 12c0 5.523 4.477 10 10 10s10-4.477 10-10S17.523 2 12 2 2 6.477 2 12z"/><path d="M15 9h.01"/><path d="M9 9h.01"/><path d="M12 16a4 4 0 0 1-4-2.5"/><path d="M16 13.5a4 4 0 0 1-4 2.5"/></svg>,
            List: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/></svg>,
            Users: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/></svg>,
            Phone: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/></svg>,
            Lock: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2" /><path d="M7 11V7a5 5 0 0110 0v4" /></svg>,
            MessageCircle: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path d="M21 11.5a8.38 8.38 0 01-.9 3.8 8.5 8.5 0 01-7.6 4.7 8.38 8.38 0 01-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 01-.9-3.8 8.5 8.5 0 014.7-7.6 8.38 8.38 0 013.8-.9h.5a8.48 8.48 0 018 8v.5z"/></svg>,
            Calendar: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" /><line x1="16" y1="2" x2="16" y2="6" /><line x1="8" y1="2" x2="8" y2="6" /><line x1="3" y1="10" x2="21" y2="10" /></svg>,
            Trash: () => <svg className="w-4 h-4" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6" /><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2" /></svg>
        };

        const AppContext = createContext();

        // --- Mock Data ---
        const glossaryTerms = [
            { term: "גזלייטינג (Gaslighting)", def: "מניפולציה שגורמת לקורבן לפקפק בשפיותו, בזיכרונו ובתפיסת המציאות שלו." },
            { term: "הפצצת אהבה (Love Bombing)", def: "הרעפת חיבה, מתנות ותשומת לב מוגזמת בתחילת הקשר כדי ליצור תלות רגשית מהירה." },
            { term: "אספקה נרקיסיסטית (Supply)", def: "ה'דלק' של הנרקיסיסט: תשומת לב, הערצה או תגובה רגשית (חיובית או שלילית) מהסביבה." },
            { term: "קופים מעופפים (Flying Monkeys)", def: "אנשים שהנרקיסיסט מגייס לצדו כדי להפיץ שמועות, לרגל או לפגוע בקורבן בשמו." },
            { term: "הוורינג (Hoovering)", def: "ניסיונות 'לשאוב' את הקורבן חזרה לקשר לאחר פרידה, באמצעות הבטחות שווא או דרמה." },
            { term: "טריאנגולציה (Triangulation)", def: "הכנסת צלע שלישית (אדם אחר) לדינמיקה כדי ליצור קנאה, תחרות וחוסר ביטחון." }
        ];

        const survivorStories = [
            { title: "חשבתי שאני משתגעת", content: "הוא היה אומר לי שדמיינתי דברים שאמר רק אתמול. לקח לי שנתיים להבין שזה גזלייטינג. היום אני בחוץ.", author: "אנונימית, 34" },
            { title: "המתנות היו מלכודת", content: "בהתחלה זה היה כמו סרט. פרחים, מסעדות. אבל על כל מתנה שילמתי אחר כך בביקורת אינסופית.", author: "ד.ל." },
            { title: "האבן האפורה הצילה אותי", content: "לא יכולתי להתגרש מיד, אז הפכתי למשעממת. הפסקתי להגיב לדרמות. הוא פשוט איבד עניין.", author: "שירה" }
        ];

        // --- Navigation ---
        const Navbar = ({ setPage, activePage }) => (
            <nav className="fixed top-0 w-full z-50 glass-nav px-6 py-4">
                <div className="max-w-7xl mx-auto flex justify-between items-center">
                    <div className="flex items-center gap-2 cursor-pointer" onClick={() => setPage('home')}>
                        <div className="w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center text-white font-black shadow-lg shadow-indigo-200">N</div>
                        <span className="text-2xl font-black tracking-tighter text-slate-800 hidden md:block">NADIA</span>
                    </div>
                    <div className="hidden md:flex gap-8 font-semibold text-slate-600 text-sm">
                        {['home', 'quiz', 'glossary', 'resources', 'contact'].map(p => (
                            <button key={p} onClick={() => setPage(p)} className={`capitalize hover:text-indigo-600 transition-colors ${activePage === p ? 'text-indigo-600 font-bold' : ''}`}>
                                {{home: 'בית', quiz: 'אבחון עצמי', glossary: 'מילון', resources: 'משאבים', contact: 'יצירת קשר'}[p]}
                            </button>
                        ))}
                    </div>
                    <button onClick={() => setPage('chat')} className="bg-indigo-600 text-white px-5 py-2 rounded-full font-bold btn-primary flex items-center gap-2 text-sm">
                        <Icon.Zap /> <span className="hidden md:inline">צ'אט AI אישי</span>
                    </button>
                </div>
            </nav>
        );

        // --- Pages ---
        
        const GlossaryView = () => (
            <div className="reveal-in pt-32 pb-20 px-6 max-w-5xl mx-auto">
                <h2 className="text-4xl font-black text-center mb-12 text-slate-900">מילון המושגים השלם</h2>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    {glossaryTerms.map((item, idx) => (
                        <div key={idx} className="premium-card p-8 rounded-[2rem]">
                            <h3 className="text-xl font-bold text-indigo-600 mb-3">{item.term}</h3>
                            <p className="text-slate-600 leading-relaxed">{item.def}</p>
                        </div>
                    ))}
                </div>
            </div>
        );

        const ContactView = () => {
            const [step, setStep] = useState(1);
            const [isDiscrete, setIsDiscrete] = useState(false);
            const [topic, setTopic] = useState("");
            const [submitted, setSubmitted] = useState(false);

            const handleNext = (selectedTopic) => {
                setTopic(selectedTopic);
                setStep(2);
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                setSubmitted(true);
            };

            if (submitted) {
                return (
                    <div className="reveal-in pt-32 pb-20 px-6 max-w-2xl mx-auto text-center">
                        <div className="premium-card p-12 rounded-[3rem] border-t-4 border-green-500">
                            <div className="w-20 h-20 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-6">
                                <Icon.Heart />
                            </div>
                            <h2 className="text-3xl font-black text-slate-800 mb-4">הפנייה נשלחה בבטחה</h2>
                            <p className="text-lg text-slate-600 mb-8">
                                תודה שפנית אלינו. אנו עושים מאמץ לחזור לכל פנייה תוך 24 שעות.
                                <br/>
                                אם סימנת "דיסקרטיות מקסימלית", לא נשאיר עקבות.
                            </p>
                            
                            <div className="bg-slate-50 p-6 rounded-2xl text-right mb-8">
                                <h3 className="font-bold mb-3 text-red-600">צריכה עזרה מיידית?</h3>
                                <ul className="space-y-2 text-sm text-slate-600">
                                    <li>• ער"ן (עזרה ראשונה נפשית): <strong>1201</strong></li>
                                    <li>• מוקד חירום למניעת אלימות: <strong>118</strong></li>
                                    <li>• משטרה: <strong>100</strong></li>
                                </ul>
                            </div>

                            <button onClick={() => window.location.reload()} className="text-indigo-600 font-bold hover:underline">חזרה לדף הבית</button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="reveal-in pt-32 pb-20 px-6 max-w-3xl mx-auto">
                    <div className="text-center mb-10">
                        <h2 className="text-4xl font-black text-slate-900 mb-4">יצירת קשר בטוחה</h2>
                        <p className="text-slate-500">אנחנו כאן כדי להקשיב, בדיסקרטיות מלאה.</p>
                    </div>

                    <div className="premium-card p-8 md:p-12 rounded-[3rem] relative">
                        {/* History Wipe Tip */}
                        <div className="absolute top-6 left-6 group">
                            <button className="text-xs text-slate-400 flex items-center gap-1 hover:text-red-500 transition-colors">
                                <Icon.Trash /> מחיקת היסטוריה
                            </button>
                            <div className="absolute top-full left-0 mt-2 w-48 bg-slate-800 text-white text-xs p-3 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-20">
                                לחצי Ctrl+H (או Cmd+Y במק) כדי למחוק את היסטוריית הגלישה בדפדפן.
                            </div>
                        </div>

                        {/* Secure Badge */}
                        <div className="flex justify-center mb-8">
                            <div className="bg-green-50 text-green-700 px-4 py-1 rounded-full text-xs font-bold flex items-center gap-2 border border-green-100">
                                <Icon.Lock /> טופס מאובטח ומוצפן (SSL)
                            </div>
                        </div>

                        {step === 1 && (
                            <div className="reveal-in">
                                <h3 className="text-xl font-bold mb-6 text-center">במה נוכל לעזור היום?</h3>
                                <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                    {["ייעוץ ראשוני", "שאלה דחופה", "תיאום פגישה", "דיווח על תקלה", "אחר"].map(opt => (
                                        <button 
                                            key={opt}
                                            onClick={() => handleNext(opt)}
                                            className="p-4 rounded-2xl border border-slate-200 hover:border-indigo-500 hover:bg-indigo-50 transition-all text-slate-700 font-medium text-right"
                                        >
                                            {opt}
                                        </button>
                                    ))}
                                </div>
                                <div className="mt-8 pt-8 border-t border-slate-100">
                                    <h4 className="font-bold text-slate-800 mb-4">אפשרויות נוספות:</h4>
                                    <div className="flex flex-col sm:flex-row gap-4">
                                        <a href="https://wa.me/972524767098" target="_blank" className="flex-1 bg-green-500 text-white p-3 rounded-xl flex items-center justify-center gap-2 font-bold hover:bg-green-600 transition shadow-lg shadow-green-100">
                                            <Icon.MessageCircle /> וואטסאפ ישיר
                                        </a>
                                        <button className="flex-1 bg-blue-500 text-white p-3 rounded-xl flex items-center justify-center gap-2 font-bold hover:bg-blue-600 transition shadow-lg shadow-blue-100">
                                            <Icon.Calendar /> תיאום ביומן
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {step === 2 && (
                            <form onSubmit={handleSubmit} className="reveal-in space-y-6">
                                <div className="flex items-center gap-2 mb-2 text-sm text-indigo-600 font-bold cursor-pointer" onClick={() => setStep(1)}>
                                    <Icon.ArrowLeft /> חזרה לבחירת נושא
                                </div>
                                <h3 className="text-xl font-bold mb-4">פרטים (הכל אופציונלי לבחירתך)</h3>
                                
                                <div>
                                    <label className="block text-sm font-medium text-slate-700 mb-1">שם (אופציונלי - אפשר גם כינוי)</label>
                                    <input type="text" className="w-full p-4 bg-slate-50 rounded-xl outline-none focus:ring-2 ring-indigo-200" placeholder="איך לקרוא לך?" />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-slate-700 mb-1">איך לחזור אליך? (מייל או טלפון)</label>
                                    <input type="text" className="w-full p-4 bg-slate-50 rounded-xl outline-none focus:ring-2 ring-indigo-200" placeholder="פרטי התקשרות..." />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-slate-700 mb-1">ההודעה שלך</label>
                                    <textarea className="w-full p-4 bg-slate-50 rounded-xl outline-none focus:ring-2 ring-indigo-200 h-32" placeholder="כתבי כאן בחופשיות..." required></textarea>
                                </div>

                                <label className="flex items-start gap-3 p-4 bg-red-50 rounded-xl cursor-pointer border border-red-100">
                                    <input 
                                        type="checkbox" 
                                        checked={isDiscrete}
                                        onChange={(e) => setIsDiscrete(e.target.checked)}
                                        className="mt-1 w-5 h-5 accent-red-600" 
                                    />
                                    <div className="text-sm">
                                        <span className="font-bold text-red-700 block">דיסקרטיות מקסימלית</span>
                                        <span className="text-slate-600">נא לא להשאיר הודעה קולית ולא לשלוח מייל חוזר (אני אצור קשר שוב).</span>
                                    </div>
                                </label>

                                <button type="submit" className="w-full btn-primary text-white py-4 rounded-2xl font-bold text-lg shadow-xl">
                                    שליחה מאובטחת
                                </button>
                                <p className="text-center text-xs text-slate-400 mt-2">אנו משתדלים לענות תוך 24 שעות.</p>
                            </form>
                        )}
                    </div>
                </div>
            );
        };

        const QuizView = () => {
            const [score, setScore] = useState(0);
            const [submitted, setSubmitted] = useState(false);
            const questions = [
                "האם יש לו/לה תחושת חשיבות עצמית מופרזת (גרנדיוזיות)?",
                "האם הוא/היא זקוק/ה להערצה מתמדת ומוגזמת?",
                "האם יש חוסר יכולת להזדהות עם רגשות של אחרים (חוסר אמפתיה)?",
                "האם הוא/היא מקנא/ה באחרים או מאמין/ה שאחרים מקנאים בו/בה?",
                "האם הוא/היא מפגין/ה יחס מתנשא, יהיר או שחצני?",
                "האם הוא/היא מנצל/ת אחרים להשגת מטרות אישיות?",
                "האם הוא/היא מאמין/ה שהוא/היא 'מיוחד/ת' ושרק אנשים מיוחדים יכולים להבין אותו/ה?"
            ];

            return (
                <div className="reveal-in pt-32 pb-20 px-6 max-w-3xl mx-auto">
                    <div className="premium-card p-10 rounded-[3rem]">
                        <h2 className="text-3xl font-black text-center mb-4">האם אני בקשר עם נרקיסיסט?</h2>
                        <p className="text-center text-slate-500 mb-8">שאלון זה מבוסס על קריטריונים מה-DSM-5, אך אינו מהווה אבחנה רפואית.</p>
                        
                        {!submitted ? (
                            <div className="space-y-6">
                                {questions.map((q, i) => (
                                    <label key={i} className="flex items-start gap-4 p-4 rounded-2xl hover:bg-slate-50 cursor-pointer transition-colors border border-transparent hover:border-slate-100">
                                        <input type="checkbox" className="mt-1 w-5 h-5 accent-indigo-600" onChange={(e) => e.target.checked ? setScore(s => s+1) : setScore(s => s-1)} />
                                        <span className="text-lg text-slate-700">{q}</span>
                                    </label>
                                ))}
                                <button onClick={() => setSubmitted(true)} className="w-full btn-primary text-white py-4 rounded-2xl font-bold text-xl mt-8">קבלת תוצאות</button>
                            </div>
                        ) : (
                            <div className="text-center py-10">
                                <div className="text-6xl font-black text-indigo-600 mb-6">{score} / {questions.length}</div>
                                <h3 className="text-2xl font-bold mb-4 text-slate-800">
                                    {score >= 5 ? "דגלים אדומים משמעותיים" : "נראה שישנם מספר מאפיינים נרקיסיסטיים"}
                                </h3>
                                <p className="text-lg text-slate-600 mb-8 max-w-xl mx-auto">
                                    {score >= 5 
                                        ? "התוצאות מצביעות על סבירות גבוהה לקשר עם אדם בעל קווים נרקיסיסטיים מובהקים. מומלץ לפנות לייעוץ מקצועי ולשקול הצבת גבולות."
                                        : "גם אם הציון אינו מקסימלי, אם את/ה מרגיש/ה מצוקה בקשר, התחושה שלך היא הקובעת."}
                                </p>
                                <button onClick={() => {setSubmitted(false); setScore(0);}} className="text-indigo-600 font-bold hover:underline">להתחיל מחדש</button>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const StoriesView = () => (
            <div className="reveal-in pt-32 pb-20 px-6 max-w-6xl mx-auto">
                <div className="text-center mb-16">
                    <h2 className="text-4xl font-black mb-4">אתם לא לבד</h2>
                    <p className="text-xl text-slate-500">סיפורים אמיתיים מאנשים שהיו שם ויצאו לחופשי</p>
                </div>
                
                <div className="grid grid-cols-1 md:grid-cols-3 gap-8 mb-16">
                    {survivorStories.map((story, i) => (
                        <div key={i} className="premium-card p-8 rounded-[2.5rem] relative">
                            <div className="absolute top-8 right-8 text-6xl text-indigo-100 font-serif">"</div>
                            <h3 className="text-xl font-bold mb-4 relative z-10">{story.title}</h3>
                            <p className="text-slate-600 mb-6 relative z-10 leading-relaxed">{story.content}</p>
                            <div className="text-sm font-bold text-indigo-500 uppercase tracking-wider">{story.author}</div>
                        </div>
                    ))}
                </div>

                <div className="premium-card p-10 rounded-[3rem] bg-indigo-50 border-indigo-100 text-center max-w-3xl mx-auto">
                    <h3 className="text-2xl font-bold mb-4">יש לך סיפור לשתף?</h3>
                    <p className="text-slate-600 mb-6">שיתוף (אנונימי) הוא חלק מההחלמה ויכול לעזור לאחרים.</p>
                    <textarea className="w-full p-4 rounded-2xl border-none mb-4 outline-none focus:ring-2 ring-indigo-300" rows="3" placeholder="כתבו כאן..."></textarea>
                    <button className="bg-indigo-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-indigo-700 transition">שליחה אנונימית</button>
                </div>
            </div>
        );

        const ResourcesView = () => (
            <div className="reveal-in pt-32 pb-20 px-6 max-w-6xl mx-auto">
                <h2 className="text-4xl font-black text-center mb-12">משאבים ועזרה</h2>
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div className="premium-card p-10 rounded-[2.5rem] border-t-4 border-red-500">
                        <div className="flex items-center gap-4 mb-6">
                            <div className="p-3 bg-red-100 text-red-600 rounded-xl"><Icon.Phone /></div>
                            <h3 className="text-2xl font-bold">קווי חירום ותמיכה</h3>
                        </div>
                        <ul className="space-y-4">
                            <li className="flex justify-between items-center p-3 bg-slate-50 rounded-xl">
                                <span>קו תמיכה ישיר (נדיה)</span>
                                <a href="tel:0524767098" className="font-bold text-indigo-600 bg-white px-3 py-1 rounded-lg shadow-sm">052-476-7098</a>
                            </li>
                            <li className="flex justify-between items-center p-3 bg-slate-50 rounded-xl">
                                <span>ער"ן (עזרה ראשונה נפשית)</span>
                                <a href="tel:1201" className="font-bold text-red-600 bg-white px-3 py-1 rounded-lg shadow-sm">1201</a>
                            </li>
                            <li className="flex justify-between items-center p-3 bg-slate-50 rounded-xl">
                                <span>מוקד סיוע לנפגעי אלימות</span>
                                <a href="tel:118" className="font-bold text-red-600 bg-white px-3 py-1 rounded-lg shadow-sm">118</a>
                            </li>
                            <li className="flex justify-between items-center p-3 bg-slate-50 rounded-xl">
                                <span>סה"ר (סיוע ברשת)</span>
                                <a href="https://sahar.org.il" target="_blank" className="font-bold text-indigo-600 text-sm">לאתר</a>
                            </li>
                        </ul>
                    </div>

                    <div className="premium-card p-10 rounded-[2.5rem] border-t-4 border-indigo-500">
                        <div className="flex items-center gap-4 mb-6">
                            <div className="p-3 bg-indigo-100 text-indigo-600 rounded-xl"><Icon.BookOpen /></div>
                            <h3 className="text-2xl font-bold">המלצות קריאה</h3>
                        </div>
                        <ul className="space-y-4">
                            <li className="p-4 bg-slate-50 rounded-xl">
                                <div className="font-bold">"למה הוא עושה את זה?"</div>
                                <div className="text-sm text-slate-500">לנדי בנקרופט - חובה לקריאה.</div>
                            </li>
                            <li className="p-4 bg-slate-50 rounded-xl">
                                <div className="font-bold">"נשים שאוהבות יותר מדי"</div>
                                <div className="text-sm text-slate-500">רובין נורווד.</div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        );

        // Reusing ChatView from previous version with key fix
        const ChatView = () => {
            const { apiKey } = useContext(AppContext);
            const [input, setInput] = useState("");
            const [mode, setMode] = useState('support'); 
            const [messages, setMessages] = useState([{ role: 'bot', text: "שלום. אני נדיה. המרחב כאן בטוח. אפשר להתייעץ, לשתף או לתרגל שיחה." }]);
            const [isTyping, setIsTyping] = useState(false);

            const send = async () => {
                if(!input.trim()) return;
                const userMsg = input;
                setMessages(prev => [...prev, { role: 'user', text: userMsg }]);
                setInput("");
                setIsTyping(true);

                const prompt = mode === 'support' 
                    ? `Act as an empathetic expert on narcissism. Keep responses short and helpful. Analyze: "${userMsg}"`
                    : `Roleplay a narcissist. Be arrogant and dismissive to: "${userMsg}"`;

                try {
                    const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${apiKey}`, {
                        method: 'POST', headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                    });
                    const data = await res.json();
                    setMessages(prev => [...prev, { role: 'bot', text: data.candidates?.[0]?.content?.parts?.[0]?.text || "שגיאה" }]);
                } catch (e) { setMessages(prev => [...prev, { role: 'bot', text: "שגיאת תקשורת" }]); } 
                finally { setIsTyping(false); }
            };

            return (
                <div className={`reveal-in max-w-4xl mx-auto h-[700px] flex flex-col premium-card rounded-[3rem] overflow-hidden mt-32 mb-20 shadow-2xl border-white/50 ${mode === 'simulator' ? 'simulator-mode' : ''}`}>
                    <div className={`p-6 border-b backdrop-blur-md flex justify-between items-center sticky top-0 z-10 transition-colors ${mode === 'support' ? 'bg-white/80' : 'bg-red-50/90'}`}>
                        <div className="font-bold text-lg">{mode === 'support' ? 'נדיה - תמיכה' : 'סימולטור נרקיסיסט'}</div>
                        <div className="flex bg-slate-100 p-1 rounded-lg">
                            <button onClick={() => setMode('support')} className={`px-3 py-1 rounded-md text-sm ${mode === 'support' ? 'bg-white shadow' : ''}`}>תמיכה</button>
                            <button onClick={() => setMode('simulator')} className={`px-3 py-1 rounded-md text-sm ${mode === 'simulator' ? 'bg-white shadow text-red-600' : ''}`}>סימולטור</button>
                        </div>
                    </div>
                    <div className="flex-1 overflow-y-auto p-8 space-y-6 bg-slate-50/50">
                        {messages.map((m, i) => (
                            <div key={i} className={`flex ${m.role === 'user' ? 'justify-start' : 'justify-end'}`}>
                                <div className={`max-w-[85%] p-4 rounded-2xl shadow-sm ${m.role === 'user' ? 'chat-bubble-user text-white' : 'chat-bubble-bot border'}`}>{m.text}</div>
                            </div>
                        ))}
                        {isTyping && <div className="text-center text-slate-400 text-sm animate-pulse">מקליד...</div>}
                    </div>
                    <div className="p-6 bg-white border-t flex gap-3">
                        <input value={input} onChange={e => setInput(e.target.value)} onKeyDown={e => e.key === 'Enter' && send()} className="flex-1 p-4 bg-slate-100 rounded-xl outline-none" placeholder="הקלד/י כאן..." />
                        <button onClick={send} className="bg-indigo-600 text-white p-4 rounded-xl"><Icon.Zap /></button>
                    </div>
                </div>
            );
        };

        const HomeView = ({ setPage }) => (
            <div className="reveal-in pt-32 pb-20 px-6 max-w-7xl mx-auto">
                {/* Hero */}
                <div className="text-center mb-24">
                    <h1 className="text-6xl md:text-8xl font-black text-slate-900 mb-8 tracking-tight">להחזיר את <span className="text-indigo-600">השליטה.</span></h1>
                    <p className="text-xl text-slate-500 max-w-2xl mx-auto mb-10">הפלטפורמה המקיפה ביותר לזיהוי, התמודדות והחלמה ממערכות יחסים נרקיסיסטיות.</p>
                    <div className="flex justify-center gap-4">
                        <button onClick={() => setPage('quiz')} className="btn-primary text-white px-8 py-4 rounded-2xl font-bold">אבחון עצמי מהיר</button>
                        <button onClick={() => setPage('contact')} className="bg-white border px-8 py-4 rounded-2xl font-bold hover:bg-slate-50">יצירת קשר</button>
                    </div>
                </div>

                {/* Dashboard Grid */}
                <div className="bento-grid">
                    <div onClick={() => setPage('chat')} className="premium-card p-8 rounded-[2.5rem] col-span-1 md:col-span-2 bg-gradient-to-br from-indigo-600 to-purple-700 text-white hover:!transform-none cursor-pointer group relative overflow-hidden">
                        <div className="relative z-10">
                            <div className="flex justify-between items-start mb-8">
                                <div className="p-3 bg-white/20 rounded-2xl"><Icon.Zap /></div>
                                <span className="bg-white/20 px-3 py-1 rounded-full text-xs font-bold">AI POWERED</span>
                            </div>
                            <h3 className="text-3xl font-black mb-2">צ'אט תמיכה חכם</h3>
                            <p className="text-indigo-100 max-w-md">זמין 24/7 לניתוח הודעות, סימולציות ותרגול הצבת גבולות.</p>
                        </div>
                        <div className="absolute -right-10 -bottom-10 w-64 h-64 bg-white/10 rounded-full blur-3xl group-hover:scale-150 transition-transform"></div>
                    </div>

                    <div onClick={() => setPage('types')} className="premium-card p-8 rounded-[2.5rem] bg-white border-t-4 border-yellow-400">
                        <h3 className="text-2xl font-bold mb-2">סוגי נרקיסיזם</h3>
                        <p className="text-slate-500 mb-4">גרנדיוזי? סמוי? פגיע?</p>
                        <div className="text-indigo-600 font-bold text-sm mt-auto">למדריך המלא -></div>
                    </div>

                    <div onClick={() => setPage('stories')} className="premium-card p-8 rounded-[2.5rem] bg-slate-900 text-white">
                        <div className="flex items-center gap-3 mb-4 text-orange-400"><Icon.Users /> קהילה</div>
                        <h3 className="text-2xl font-bold mb-2">סיפורים אישיים</h3>
                        <p className="text-slate-400">לקרוא, לשתף, להבין שאתם לא לבד.</p>
                    </div>

                    <div onClick={() => setPage('contact')} className="premium-card p-8 rounded-[2.5rem] border-t-4 border-green-500">
                        <div className="flex items-center gap-3 mb-4 text-green-600"><Icon.Shield /> עזרה</div>
                        <h3 className="text-2xl font-bold mb-2">פנייה דיסקרטית</h3>
                        <p className="text-slate-500">טופס מאובטח, וואטסאפ וחירום.</p>
                    </div>
                </div>
            </div>
        );

        const TypesView = () => (
            <div className="reveal-in pt-32 pb-20 px-6 max-w-5xl mx-auto">
                <h2 className="text-4xl font-black text-center mb-12">הספקטרום הנרקיסיסטי</h2>
                <div className="grid md:grid-cols-2 gap-8">
                    <div className="premium-card p-10 rounded-[2.5rem] border-t-8 border-orange-500">
                        <h3 className="text-2xl font-black mb-4">הנרקיסיסט הגרנדיוזי</h3>
                        <ul className="space-y-3 text-slate-600 list-disc pr-5">
                            <li>מוחצן, כריזמטי, "מסמר המסיבה".</li>
                            <li>יהיר באופן גלוי, משוויץ בהישגים.</li>
                            <li>חסר בושה, מרגיש עליונות ברורה.</li>
                            <li>תוקפני כשמבקרים אותו.</li>
                        </ul>
                    </div>
                    <div className="premium-card p-10 rounded-[2.5rem] border-t-8 border-purple-500">
                        <h3 className="text-2xl font-black mb-4">הנרקיסיסט הסמוי (פגיע)</h3>
                        <ul className="space-y-3 text-slate-600 list-disc pr-5">
                            <li>נראה ביישן, מופנם או רגיש.</li>
                            <li>מרגיש ש"העולם לא מבין אותו" (קורבן נצחי).</li>
                            <li>פאסיב-אגרסיבי (שתיקות, רמזים).</li>
                            <li>רגיש מאוד לביקורת, נוטר טינה בסתר.</li>
                        </ul>
                    </div>
                </div>
            </div>
        );

        const MainApp = () => {
            const [page, setPage] = useState('home');
            const [selectedGuide, setSelectedGuide] = useState(null);
            const [apiKey] = useState('AIzaSyAekRlMPfrivHyP-NC3SXUGL5kxkAJ3LXE');

            // Panic Button Logic
            useEffect(() => {
                const handleEsc = (e) => { if (e.key === 'Escape') window.location.href = "https://www.google.com"; };
                window.addEventListener('keydown', handleEsc);
                return () => window.removeEventListener('keydown', handleEsc);
            }, []);

            const handleSetPage = (newPage) => {
                setPage(newPage);
                setSelectedGuide(null);
                window.scrollTo(0, 0);
            }

            return (
                <AppContext.Provider value={{ apiKey }}>
                    <div className="min-h-screen pb-20">
                        <Navbar setPage={handleSetPage} activePage={page} />
                        
                        <main>
                            {page === 'home' && <HomeView setPage={handleSetPage} />}
                            {page === 'features' && <FeaturesView />}
                            {page === 'chat' && <ChatView />}
                            {page === 'guides' && !selectedGuide && <GuidesView setViewGuide={setSelectedGuide} />}
                            {page === 'guides' && selectedGuide && <ArticleView guide={selectedGuide} onBack={() => setSelectedGuide(null)} />}
                            {page === 'about' && (
                                <div className="reveal-in py-20 px-6 max-w-4xl mx-auto text-right pt-40">
                                    <h2 className="text-5xl font-black mb-10 text-slate-900">החזון שלנו</h2>
                                    <div className="premium-card p-12 rounded-[3rem] text-xl leading-loose text-slate-700 space-y-6">
                                        <p>אנחנו מאמינים שלכל אדם מגיע להרגיש בטוח בביתו ובעולמו הפנימי. נדיה נוצרה כדי לגשר על הפער שבין "הרגשה שמשהו לא בסדר" לבין "הבנה מוחלטת של המציאות".</p>
                                        <p>אנחנו משלבים חדשנות טכנולוגית עם אמפתיה אנושית כדי שאתם לעולם לא תרגישו לבד שוב. האתר נבנה מתוך מחקר מעמיק והבנה של הצרכים הייחודיים של המתמודדים עם מערכות יחסים מורכבות.</p>
                                    </div>
                                </div>
                            )}
                            {page === 'quiz' && <QuizView />}
                            {page === 'glossary' && <GlossaryView />}
                            {page === 'resources' && <ResourcesView />}
                            {page === 'stories' && <StoriesView />}
                            {page === 'types' && <TypesView />}
                            {page === 'contact' && <ContactView />}
                        </main>

                        <button 
                            onClick={() => window.location.href = "https://www.google.com"}
                            className="fixed bottom-8 left-8 bg-red-500 text-white w-16 h-16 rounded-full shadow-2xl flex items-center justify-center hover:scale-110 transition-transform z-50 group"
                            title="יציאה מהירה (Esc)"
                        >
                            <Icon.Exit />
                            <span className="absolute left-full ml-4 bg-slate-800 text-white px-3 py-1 rounded-lg text-sm whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none">יציאה מהירה</span>
                        </button>
                    </div>
                </AppContext.Provider>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MainApp />);
    </script>
</body>
</html>
